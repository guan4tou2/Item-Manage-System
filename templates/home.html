{%extends 'template.html' %} {%block title%}é¦–é  - ç‰©å“ç®¡ç†ç³»çµ±{%endblock%}
{%block user%}{{User.User}}{%endblock%} {%block contain%}
<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <h1 class="display-4 text-center mb-4">ğŸ  æˆ‘çš„ç‰©å“ç®¡ç†ç³»çµ±</h1>
      <p class="lead text-center mb-5">
        è¼•é¬†è¨˜éŒ„å®¶ä¸­ç‰©å“ä½ç½®ï¼Œå†ä¹Ÿä¸æ€•æ‰¾ä¸åˆ°æ±è¥¿ï¼
      </p>
    </div>
  </div>

  <!-- æœå°‹åŠŸèƒ½ -->
  <div class="row mb-4">
    <div class="col-md-8 mx-auto">
      <form action="{{ url_for('items.search') }}" method="GET" class="row g-2">
        <div class="col-md-3">
          <input
            type="text"
            name="q"
            class="form-control"
            placeholder="æœå°‹ç‰©å“åç¨±..."
            value="{{ request.args.get('q', '') }}"
          />
        </div>
        <div class="col-md-3">
          <input
            type="text"
            name="place"
            class="form-control"
            placeholder="æœå°‹æ”¾ç½®åœ°é»..."
            value="{{ request.args.get('place', '') }}"
          />
        </div>
        <div class="col-md-2">
          <select name="type" class="form-select">
            <option value="">å…¨éƒ¨é¡å‹</option>
            {% for type in itemtype %}
            <option value="{{type.name}}" {% if request.args.get('type','')==type.name %}selected{% endif %}>{{type.name}}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-1">
          <select name="floor" class="form-select">
            <option value="">æ¨“å±¤</option>
            {% for f in floors %}
            <option value="{{f}}" {% if request.args.get('floor','')==f %}selected{% endif %}>{{f}}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-1">
          <select name="room" class="form-select">
            <option value="">æˆ¿é–“</option>
            {% for r in rooms %}
            <option value="{{r}}" {% if request.args.get('room','')==r %}selected{% endif %}>{{r}}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-1">
          <select name="zone" class="form-select">
            <option value="">å€åŸŸ</option>
            {% for z in zones %}
            <option value="{{z}}" {% if request.args.get('zone','')==z %}selected{% endif %}>{{z}}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-1">
          <select name="sort" class="form-select">
            <option value="">æ’åº</option>
            <option value="name" {% if selected_sort=='name' %}selected{% endif %}>åç¨±</option>
            <option value="warranty" {% if selected_sort=='warranty' %}selected{% endif %}>ä¿å›ºåˆ°æœŸ</option>
            <option value="usage" {% if selected_sort=='usage' %}selected{% endif %}>ä½¿ç”¨æœŸé™</option>
          </select>
        </div>
        <div class="col-12 d-flex justify-content-end">
          <button type="submit" class="btn btn-primary me-2">ğŸ” æœå°‹</button>
          <a href="{{ url_for('items.scan') }}" class="btn btn-outline-info">ğŸ“· æƒæ</a>
        </div>
      </form>
    </div>
  </div>

  <!-- çµ±è¨ˆè³‡è¨Š -->
  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card text-center bg-primary text-white">
        <div class="card-body">
          <h5 class="card-title">ç¸½ç‰©å“æ•¸</h5>
          <h2 class="card-text">{{ items|length }}</h2>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-center bg-success text-white">
        <div class="card-body">
          <h5 class="card-title">æœ‰ç…§ç‰‡</h5>
          <h2 class="card-text">
            {{ items|selectattr('ItemPic', 'ne', '')|list|length }}
          </h2>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-center bg-info text-white">
        <div class="card-body">
          <h5 class="card-title">æœ‰ä½ç½®è¨˜éŒ„</h5>
          <h2 class="card-text">
            {{ items|selectattr('ItemStorePlace', 'ne', '')|list|length }}
          </h2>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-center bg-warning text-white">
        <div class="card-body">
          <h5 class="card-title">æœ‰åˆ†é¡</h5>
          <h2 class="card-text">
            {{ items|selectattr('ItemType', 'ne', '')|list|length }}
          </h2>
        </div>
      </div>
    </div>
  </div>
</div>
{%endblock%} {%block card%}
<div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">
  {%for item in items%}
  <div class="col">
    <div class="card h-100 shadow-sm">
      {%if item.ItemPic%}
      <img
        src="{{ url_for('items.uploaded_file', filename=item.ItemPic) }}"
        class="card-img-top"
        alt="{{ item.ItemName }}"
        style="height: 200px; object-fit: cover"
      />
      {%else%}
      <div
        class="card-img-top bg-light d-flex align-items-center justify-content-center"
        style="height: 200px"
      >
        <i class="fas fa-image fa-3x text-muted"></i>
      </div>
      {%endif%}
      <div class="card-body">
        <h5 class="card-title">{{item.ItemName}}</h5>
        <p class="card-text text-muted">ID: {{item.ItemID}}</p>
        {%if item.ItemStorePlace%}
          <p class="card-text">
            <strong>ğŸ“ æ”¾ç½®åœ°é»:</strong> {{item.ItemStorePlace}}
          </p>
        {%endif%}
        {%if item.ItemFloor or item.ItemRoom or item.ItemZone%}
          <p class="card-text">
            <strong>ğŸ  ä½ç½®å±¤ç´š:</strong> {{item.ItemFloor}} {{item.ItemRoom}} {{item.ItemZone}}
          </p>
        {%endif%}
        {%if item.ItemType%}
          <p class="card-text"><strong>ğŸ“‚ é¡å‹:</strong> {{item.ItemType}}</p>
        {%endif%} {%if item.ItemOwner%}
          <p class="card-text"><strong>ğŸ‘¤ æ“æœ‰è€…:</strong> {{item.ItemOwner}}</p>
        {%endif%} {%if item.ItemGetDate%}
          <p class="card-text">
            <strong>ğŸ“… å–å¾—æ—¥æœŸ:</strong> {{item.ItemGetDate}}
          </p>
        {%endif%}
        {%if item.WarrantyExpiry%}
          <p class="card-text">
            <strong>ğŸ›¡ ä¿å›ºæˆªæ­¢:</strong> {{item.WarrantyExpiry}}
            {% if item.WarrantyStatus=='expired' %}<span class="badge bg-danger ms-1">åˆ°æœŸ</span>{% elif item.WarrantyStatus=='near' %}<span class="badge bg-warning text-dark ms-1">å³å°‡åˆ°æœŸ</span>{% endif %}
          </p>
        {%endif%}
        {%if item.UsageExpiry%}
          <p class="card-text">
            <strong>âŒ› ä½¿ç”¨æœŸé™:</strong> {{item.UsageExpiry}}
            {% if item.UsageStatus=='expired' %}<span class="badge bg-danger ms-1">åˆ°æœŸ</span>{% elif item.UsageStatus=='near' %}<span class="badge bg-warning text-dark ms-1">å³å°‡åˆ°æœŸ</span>{% endif %}
          </p>
        {%endif%}
        {%if item.ItemDesc%}
          <p class="card-text">{{item.ItemDesc}}</p>
        {%endif%}
      </div>
      <div class="card-footer">
        <div class="d-flex justify-content-between">
          <a
            href="{{ url_for('items.manageitem') }}?id={{item.ItemID}}"
            class="btn btn-primary btn-sm"
            >âœï¸ ç·¨è¼¯</a
          >
          <a
            href="{{ url_for('items.search') }}?q={{item.ItemName}}"
            class="btn btn-info btn-sm"
            >ğŸ” æœå°‹ç›¸ä¼¼</a
          >
          <div class="btn-group btn-group-sm">
            <a class="btn btn-outline-secondary" href="{{ url_for('items.qrcode_image', item_id=item.ItemID) }}">QR</a>
            <a class="btn btn-outline-secondary" href="{{ url_for('items.barcode_image', item_id=item.ItemID) }}">æ¢ç¢¼</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  {%endfor%}
</div>

{%if not items%}
<div class="text-center py-5">
  <i class="fas fa-box-open fa-5x text-muted mb-3"></i>
  <h3 class="text-muted">é‚„æ²’æœ‰ä»»ä½•ç‰©å“</h3>
  <p class="text-muted">é»æ“Šä¸‹æ–¹æŒ‰éˆ•é–‹å§‹è¨˜éŒ„æ‚¨çš„ç¬¬ä¸€å€‹ç‰©å“å§ï¼</p>
  <a href="{{ url_for('items.additem') }}" class="btn btn-primary btn-lg"
    >â• æ–°å¢ç‰©å“</a
  >
</div>
{%endif%} {%endblock%} {%block page%} {%if items|length > 8%}
<nav aria-label="Page navigation example">
  <ul class="pagination justify-content-center">
    <li class="page-item">
      <a class="page-link" href="#" aria-label="Previous">
        <span aria-hidden="true">&laquo;</span>
      </a>
    </li>
    <li class="page-item"><a class="page-link" href="#">1</a></li>
    <li class="page-item"><a class="page-link" href="#">2</a></li>
    <li class="page-item"><a class="page-link" href="#">3</a></li>
    <li class="page-item">
      <a class="page-link" href="#" aria-label="Next">
        <span aria-hidden="true">&raquo;</span>
      </a>
    </li>
  </ul>
</nav>
{%endif%} {%endblock%}
